:root{
  --bg:#f8f6f4; --paper:#ffffff; --ink:#2e2a27; --sub:#6f6a67;
  --primary:#a684ff; --primary-weak:#ece5ff; --danger:#ef4444;
  --radius:16px; --shadow:0 10px 28px rgba(0,0,0,.08);
  --gap:clamp(8px, 2.5vw, 12px);
  --fs-base:clamp(14px, 3.6vw, 16px);
  --fs-sm:clamp(12px, 3.2vw, 14px);
  --fs-lg:clamp(18px, 4.6vw, 22px);
  --tap:44px;
  --dock-h:64px;      /* 하단바 높이 */
  --kb-gap:0px;       /* JS에서 주입(visualViewport) */
}
*{box-sizing:border-box}
html,body{
  margin:0; padding:0; background:var(--bg); color:var(--ink);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;
  font-size:var(--fs-base);
}
body{ padding-bottom: var(--kb-gap); }

.app{
  max-width:900px; margin:0 auto;
  min-height:100dvh; display:flex; flex-direction:column;
  /* 평소에는 하단바 공간만큼 여유 */
  padding:clamp(10px,2.6vw,16px) clamp(10px,2.6vw,16px)
          calc(var(--dock-h) + env(safe-area-inset-bottom) + var(--gap));
}
.hdr{display:flex;align-items:center;justify-content:space-between;margin:6px 0 clamp(8px,2vw,14px)}
.brand{font-weight:800;font-size:clamp(20px,5.2vw,26px);letter-spacing:.3px}
.today-pill{background:var(--primary-weak);color:#5a45b8;border-radius:999px;padding:6px 10px;font-size:var(--fs-sm)}

.card{background:var(--paper);border-radius:var(--radius);box-shadow:var(--shadow);padding:clamp(12px,3vw,16px);margin:clamp(8px,2.2vw,12px) 0}
.card h2{margin:0 0 8px;font-size:var(--fs-lg)}
.muted{color:var(--sub);font-size:var(--fs-sm)}
.row{display:flex;gap:var(--gap);flex-wrap:wrap}

.btn{
  padding:12px 14px; border-radius:12px; border:1px solid #e7e3ff; background:#fff; cursor:pointer;
  min-height:var(--tap); line-height:1; font-size:var(--fs-base);
  touch-action: manipulation;
}
.btn.primary{background:var(--primary);color:#fff;border-color:transparent}
.btn:disabled{opacity:.5;cursor:not-allowed}
.grow{flex:1}

/* 달력 */
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:clamp(4px,1.4vw,6px)}
.dow{font-size:var(--fs-sm);color:var(--sub);text-align:center}
.day{
  aspect-ratio:1/1; border-radius:12px; background:#fff; display:flex; align-items:center; justify-content:center;
  border:1px solid #eee; font-weight:600; cursor:pointer; position:relative;
  min-height:var(--tap); font-size:clamp(12px, 3.6vw, 14px);
  touch-action: manipulation;
}
.day.today{outline:2px solid var(--primary)}
.day.selected{background:var(--primary-weak);border-color:#cfc3ff}
.day.disabled{opacity:.35;pointer-events:none}

/* 감정 타일 */
.moods{display:grid;grid-template-columns:repeat(6,1fr);gap:clamp(6px,2vw,8px)}
.mood{padding:10px;border:1px solid #eee;border-radius:12px;background:#fff;text-align:center;cursor:pointer;user-select:none;min-height:var(--tap)}
.mood .em{font-size:clamp(18px,6vw,22px);display:block}
.mood.active{border-color:#cfc3ff;background:var(--primary-weak)}
.mood:active{transform:scale(.98)}

/* 입력 */
textarea, input[type="text"]{
  width:100%; border:1px solid #e9e4ff; border-radius:12px; padding:12px; background:#fff; font-size:var(--fs-base);
  min-height:var(--tap);
}
#praise{height:14svh; min-height:64px; resize:vertical; line-height:1.4}
#diary{height:34svh; min-height:220px; resize:vertical}

.counter{font-size:var(--fs-sm);color:var(--sub);text-align:right;margin-top:6px}

/* 기록/통계 */
.entry{border:1px dashed #eee;border-radius:12px;padding:10px;margin-top:8px}
.entry .meta{display:flex;gap:8px;align-items:center;font-size:var(--fs-sm);color:var(--sub)}
.chip{background:#f2f1ff;color:#5a45b8;border-radius:999px;padding:2px 8px;font-weight:600}
.actions{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:var(--gap)}
.stat{background:#fff;border-radius:12px;border:1px solid #eee;padding:10px;text-align:center}
.stat .k{font-size:var(--fs-sm);color:var(--sub)}
.stat .v{font-size:clamp(16px,4.2vw,18px);font-weight:800}

/* 하단 탭바 (복구) */
.dock{
  position:fixed; left:0; right:0; bottom:0;
  backdrop-filter:saturate(180%) blur(6px);
  background:rgba(255,255,255,.9); border-top:1px solid #eee;
  padding:8px 12px calc(8px + env(safe-area-inset-bottom));
  transition: transform .22s ease, opacity .22s ease;
  display:block !important; /* 혹시 이전 규칙이 있어도 이게 이김 */
}
.dock .tabs{max-width:900px;margin:0 auto;display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.tabbtn{
  padding:10px 6px; border-radius:10px; border:1px solid #e7e3ff; background:#fff; cursor:pointer; font-size:var(--fs-sm);
  min-height:var(--tap)
}
.tabbtn.active{background:var(--primary-weak);border-color:#cfc3ff;font-weight:700;color:#5a45b8}

/* 뷰 전환 */
.view{display:none}
.view.active{display:block}

/* 키보드 열리면: 하단바 내리고, 하단 여유 줄이기 */
body.kb-open .dock{ transform: translateY(120%); opacity:0; pointer-events:none; }
body.kb-open .app{ padding-bottom: clamp(10px,2.6vw,16px); }

/* 스크롤 컨테이너 */
.chat-list{ flex:1 1 auto; overflow:auto; -webkit-overflow-scrolling:touch; }

/* 반응형 */
@media (min-width:600px){
  #diary{height:38svh}
  #praise{height:16svh}
}



